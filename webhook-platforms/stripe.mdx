---
title: "Stripe Integration"
description: "Set up webhooks to receive notifications for payment and subscription events from Stripe"
---

# Stripe Integration

This guide will walk you through setting up a webhook integration between Stripe and HookFlo, enabling you to receive alerts for payment, subscription, and other financial events.

<Note>
  Stripe webhooks are secured using a signing secret that verifies the authenticity of each webhook event. HookFlo uses this signature to validate that incoming requests are genuinely from Stripe.
</Note>

## Prerequisites

- A HookFlo account with an active project
- A Stripe account with admin access
- Basic understanding of Stripe's payment processing system

## Integration Steps

<Steps>
  <Step title="Create a Webhook in HookFlo">
    <Accordion title="Setting Up Your Webhook Endpoint">
      1. Log in to your HookFlo dashboard
      2. Navigate to **Integrations** > **Webhook Platforms**
      3. Click on **+ Add New** and select **Stripe**
      4. A unique webhook URL will be generated
      5. You'll enter your Stripe webhook signing secret in the next steps
      
      ![Stripe Integration Setup](/images/stripe-integration.png)
      
      Keep this page open as you'll need the webhook URL for the next step.
    </Accordion>
  </Step>

  <Step title="Create a Webhook Endpoint in Stripe">
    <Accordion title="Configuring Stripe to Send Webhooks">
      1. Log in to your [Stripe Dashboard](https://dashboard.stripe.com/)
      2. Navigate to **Developers** > **Webhooks**
      3. Click **Add endpoint**
      4. Enter your HookFlo webhook URL from the previous step
      5. Under **Events to send**, select the events you want to monitor
      6. Click **Add endpoint**
      
      After creating the endpoint, you'll be shown the webhook signing secret. This is a key piece of information needed to verify webhook authenticity.
      
      ![Stripe Webhook Configuration](/images/stripe-webhook-setup.png)
    </Accordion>
  </Step>

  <Step title="Configure Webhook Verification in HookFlo">
    <Accordion title="Setting Up Webhook Verification">
      1. In your Stripe dashboard, find your newly created webhook endpoint
      2. Click **Reveal** next to the signing secret
      3. Copy the signing secret (it should start with `whsec_`)
      4. Return to the HookFlo dashboard
      5. Paste the signing secret into the "Webhook Signing Secret" field
      6. Click **Save Configuration**
      
      This secret allows HookFlo to verify that incoming webhooks are genuinely from Stripe, preventing spoofing attacks.
    </Accordion>
  </Step>

  <Step title="Test Your Integration">
    <Accordion title="Verifying the Setup">
      To test that your webhook is working correctly:

      1. In the Stripe dashboard, find your webhook endpoint
      2. Click **Send test webhook**
      3. Select an event type (e.g., `payment_intent.succeeded`)
      4. Click **Send test webhook** to deliver a sample webhook to HookFlo
      5. Go to your HookFlo dashboard and check the **Event Logs** section
      6. You should see the test event appear with details
      
      You can also test with a real event by creating a test payment in your Stripe dashboard.
    </Accordion>
  </Step>
</Steps>

## Supported Events

Stripe offers a comprehensive set of webhook events. Here are some of the most commonly used categories:

### Payment Events
- `payment_intent.succeeded`: When a payment is successfully processed
- `payment_intent.payment_failed`: When a payment attempt fails
- `charge.succeeded`: When a charge is successful
- `charge.failed`: When a charge fails
- `charge.refunded`: When a charge is refunded

### Customer Events
- `customer.created`: When a new customer is created
- `customer.updated`: When customer details are updated
- `customer.deleted`: When a customer is deleted

### Subscription Events
- `customer.subscription.created`: When a subscription is created
- `customer.subscription.updated`: When a subscription is updated
- `customer.subscription.deleted`: When a subscription is canceled
- `invoice.payment_succeeded`: When a subscription payment succeeds
- `invoice.payment_failed`: When a subscription payment fails

### Product & Price Events
- `product.created`: When a product is created
- `price.created`: When a price is created
- `product.updated`: When a product is updated

For a complete list of events, refer to the [Stripe API documentation](https://stripe.com/docs/api/events/types).

## Webhook Headers

Stripe webhooks include this important header that HookFlo uses for verification:

- `stripe-signature`: A signature that proves the webhook came from Stripe

## Webhook Payload Structure

Here's an example of what the webhook payload looks like for a `payment_intent.succeeded` event:

```json
{
  "id": "evt_1NwXaIJFJbz6iDgO7bCoVSfK",
  "object": "event",
  "api_version": "2022-11-15",
  "created": 1633027930,
  "data": {
    "object": {
      "id": "pi_3NwXaHJFJbz6iDgO0gnbIVoc",
      "object": "payment_intent",
      "amount": 2000,
      "amount_received": 2000,
      "currency": "usd",
      "customer": "cus_LTf0miiJ4j18Ny",
      "payment_method": "pm_1NwXaHJFJbz6iDgObthB6dgO",
      "payment_method_types": ["card"],
      "status": "succeeded"
    }
  },
  "livemode": false,
  "type": "payment_intent.succeeded"
}
```

## Handling Test vs. Live Events

Stripe has separate webhook endpoints for test and live modes. Best practices:

- Set up separate webhooks in HookFlo for test and live environments
- Use clear naming conventions to distinguish between test and production webhooks
- Configure different notification channels for test vs. live events

## Troubleshooting

<AccordionGroup>
  <Accordion title="Webhook Signature Verification Failures">
    If you're seeing signature verification errors:
1. Double-check that you've entered the correct signing secret in HookFlo
2. Ensure you're using the signing secret for the specific webhook endpoint
3. Check if the signing secret has been rotated in Stripe recently
4. Verify your server's clock is accurately synchronized (time drift can cause verification failures)
  </Accordion>
  <Accordion title="Missing Events">
    If certain events aren't being received:
1. Verify that you've selected those specific event types in Stripe's webhook configuration
2. Check Stripe's webhook delivery logs to confirm they're being sent
3. Ensure your HookFlo webhook is active and properly configured
  </Accordion>
  <Accordion title="Webhook Timeouts">
    If webhook deliveries are timing out:
1. Check Stripe's webhook logs for timeout errors 
2. Stripe will automatically retry webhook deliveries that fail
3. You can manually trigger a retry from the Stripe dashboard
  </Accordion>
</AccordionGroup>

## Example: Alerting on Failed Payments

Here's a complete example of setting up HookFlo to alert your team when payments fail:

<Steps>
  <Step title="Configure the Events in Stripe">
    In your Stripe webhook settings, ensure the `payment_intent.payment_failed` event is selected.
  </Step>
  <Step title="Create an Alert Rule in HookFlo">
    In HookFlo:
    1. Go to **Alert Rules** > **Create Rule**
    2. Select your Stripe webhook as the source
    3. Add a condition: `type equals payment_intent.payment_failed`
    4. Select your notification channel (e.g., Slack)
    5. Customize the message: 
       ```
       ðŸš¨ Payment Failed ðŸš¨
       Amount: {{data.object.amount | currency(data.object.currency)}}
       Customer: {{data.object.customer}}
       Reason: {{data.object.last_payment_error.message}}
       Time: {{created | date}}
       ```
    6. Save the rule
  </Step>
  <Step title="Test the Integration">
    Use Stripe's test mode to simulate a failed payment and verify that you receive the notification in your selected channel.
  </Step>
</Steps>

## Security Considerations

When working with Stripe webhooks, keep these security practices in mind:

- Protect your signing secret: Never expose the Stripe signing secret in client-side code
- Validate all webhooks: Always verify the signature of incoming webhooks
- Use HTTPS only: Ensure all webhook URLs use encrypted connections
- Implement proper access controls: Limit who can view sensitive payment information
- PCI compliance: Be careful about storing or logging complete payment details

## Next Steps

- Configure Slack notifications for your Stripe events
- Set up Email alerts for critical payment events
- Explore Security best practices for webhook integrations
- Check out the Stripe webhooks documentation for advanced configurations